# Эффективное управление swap в Ubuntu: когда, зачем и как изменить размер

Эффективное управление swap в Ubuntu — ключевой фактор стабильной работы системы. Правильная настройка подкачки напрямую влияет на скорость выполнения процессов, загрузку памяти и общее поведение ОС. Особенно это важно для пользователей, которые работают с ресурсоёмкими приложениями или ограниченным объёмом оперативной памяти. Подробнее о том, как грамотно подходить к теме оптимизации swap, можно найти и на https://andreyex.ru/, где рассматриваются базовые и расширенные приёмы администрирования.

В данной статье будут рассмотрены основные методы изменения размера swap, мониторинг его использования и практики, повышающие производительность без риска повреждения системы.

## **Что такое swap в Ubuntu**

Swap (файл подкачки или раздел подкачки) — это область на жёстком диске или SSD, которая используется операционной системой Ubuntu для временного хранения данных из оперативной памяти. Когда RAM полностью занята, система перемещает часть информации в swap, чтобы продолжить выполнение процессов.

## **Когда нужно изменять размер swap**

Корректировка размера swap требуется в следующих случаях:

- **при нехватке оперативной памяти**
- **при увеличении нагрузки на систему из-за тяжёлых приложений**
- **при переходе на более новые версии Ubuntu**
- **при необходимости гибернации ноутбука (требуется swap равный или больше объёма RAM)**

## **Почему важно управление swap**

Без грамотного управления swap возникает риск замедления работы системы, так как обращение к диску в десятки раз медленнее, чем к RAM. Кроме того, чрезмерно маленький swap приводит к аварийному завершению приложений.

## **Основные техники изменения размера swap**

В Ubuntu можно изменять swap несколькими способами:

- **использование файла подкачки**
- **управление отдельным разделом**
- **комбинированный подход**

Каждый метод имеет особенности и уровень сложности.

## **Как изменить размер swap-файла**

Выключение swap:

```jsx
sudo swapoff -a
```

Удаление текущего файла:

```jsx
sudo rm /swapfile
```

Создание нового файла необходимого размера (например, 4 ГБ):

```jsx
sudo fallocate -l 4G /swapfile
```

Установка прав доступа:

```jsx
sudo chmod 600 /swapfile
```

Настройка файла как swap:

```jsx
sudo mkswap /swapfile
sudo swapon /swapfile
```

Обновление /etc/fstab для автоматической активации при загрузке.

## **Как изменить размер swap-раздела**

При использовании выделенного раздела потребуется:

- **загрузка с LiveCD/USB**
- **использование утилиты GParted для изменения размера**
- **обновление записи в /etc/fstab**

## **Мониторинг использования swap**

Для анализа текущего состояния swap применяются утилиты:

- **free -h** — отображает общий объём, используемый и доступный swap
- **swapon --show** — показывает активные устройства swap
- **vmstat** — предоставляет статистику использования памяти
- **htop** — интерактивный мониторинг нагрузки

## **Основные команды для работы с swap**

| Команда | Назначение | Пример использования |
| --- | --- | --- |
| free -h | Просмотр объёма swap | free -h |
| swapon --show | Отображение активного swap | swapon --show |
| swapoff -a | Отключение swap | sudo swapoff -a |
| mkswap | Создание swap-файла | sudo mkswap /swapfile |
| fallocate | Выделение места под swap-файл | sudo fallocate -l 4G /swapfile |

## **Оптимизация работы swap**

Оптимизация заключается в настройке параметров ядра и использовании SSD.

- **swappiness** — определяет частоту использования swap. Значение от 0 до 100. Для настольных систем обычно устанавливают 10–20.
- **vm.vfs_cache_pressure** — влияет на освобождение кэша файловой системы. Оптимально уменьшить значение до 50–60.

Пример настройки:

```jsx
sudo sysctl vm.swappiness=15
sudo sysctl vm.vfs_cache_pressure=60
```

## **Рекомендуемые значения параметров swap**

| Параметр | Значение по умолчанию | Рекомендуемое значение |
| --- | --- | --- |
| vm.swappiness | 60 | 10–20 |
| vm.vfs_cache_pressure | 100 | 50–60 |

## **Безопасность изменения swap**

Для предотвращения ошибок рекомендуется:

- **делать резервную копию /etc/fstab**
- **не изменять размер swap во время высокой нагрузки**
- **проверять права доступа к swap-файлу (0600)**

## **Частые ошибки при управлении swap**

- **неправильно указанный путь к swap-файлу**
- **отсутствие обновления /etc/fstab**
- **установка слишком маленького или слишком большого размера**

## **FAQs**

### **Что произойдёт, если отключить swap в Ubuntu?**

Система будет использовать только оперативную память. При её нехватке приложения могут аварийно завершаться.

### **Можно ли полностью удалить swap?**

Да, но это не рекомендуется. Без swap стабильность системы снижается.

### **Как узнать оптимальный размер swap?**

Если система используется для стандартных задач, достаточно 2–4 ГБ. Для серверов и рабочих станций — от 8 ГБ и выше.

### **Можно ли использовать несколько файлов swap одновременно?**

Да, Ubuntu поддерживает несколько файлов или разделов swap.

### **Как проверить текущую нагрузку на swap?**

С помощью команд free -h или htop.

### **Что лучше — swap-файл или раздел?**

Современные версии Ubuntu рекомендуют swap-файл из-за простоты управления.

## **Заключение**

Эффективное управление swap в Ubuntu позволяет поддерживать стабильность системы, оптимизировать производительность и избежать сбоев при работе с тяжёлыми приложениями. Безопасное изменение размера swap, регулярный мониторинг его использования и грамотная настройка параметров ядра — основные шаги для пользователей, которые хотят добиться максимальной эффективности.
